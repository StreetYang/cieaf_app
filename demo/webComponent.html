<!DOCTYPE html>
<html>

<head>
    <script src="./cieaf_app.js"></script>
</head>

<body>
    <script>
        const { h, createApp } = cieaf_app;

        function main(ctx) {
            function add() {
                ctx.count++;
            }
            return h`<a @click=${add}>count:${ctx.count}</a>`
        }

        class MyElement extends HTMLElement {
            static get observedAttributes() { return ['count']; }

            constructor() {
                super();
                this.attachShadow({ mode: 'open' });
                this.ctx = createApp(this, main, { count: 0 });

                const css = new CSSStyleSheet();
                css.replaceSync('a{color:red}');
                this.shadowRoot.adoptedStyleSheets.push(css);
            }

            get count() { return this.ctx.count }

            set count(v) { this.setAttribute('count', v) }

            attributeChangedCallback(name, oldValue, newValue) {
                this.ctx[name] = parseInt(newValue);
            }
        }

        customElements.define('my-count', MyElement);
    </script>

    <my-count count="10"></my-count>
</body>

</html>